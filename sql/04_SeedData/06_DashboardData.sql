-- 1. 清理环境（可选）
TRUNCATE TABLE HistoryTrend;
TRUNCATE TABLE RealtimeSummary;
TRUNCATE TABLE DashboardConfig;
GO

-- =============================================
-- 2. 插入 DashboardConfig (仪表盘配置)
-- 策略：ModuleCode 用中文，时间统一为秒
-- =============================================

INSERT INTO DashboardConfig (ModuleCode, RefreshIntervalSeconds, DisplayFields, SortRule, PermissionLevel)
VALUES
-- 1分钟 (60秒) 刷新一次
('能源总览', 60, '总能耗,总碳排放,今日水耗,今日气耗', '默认排序', '管理员'),

-- 5分钟 (300秒) 刷新一次 -> 光伏数据变化较慢，不需要太频繁
('光伏总览', 300, '光伏发电量,自用电量,并网电量,节能减排量', '按发电量降序', '能源管理员'),

-- 10秒 刷新一次 -> 运维监控需要高实时性
('配电网运行状态', 10, '变压器负载率,A/B/C三相电压,线圈温度', '按负载率降序', '运维人员'),

-- 30秒 刷新一次 -> 管理员看告警概览
('告警统计', 30, '高等级告警数,未处理告警占比,告警趋势图', '按严重程度降序', '管理员'),

-- 15秒 刷新一次 -> 运维看具体故障
('告警统计', 15, '实时告警列表,设备故障代码', '按时间降序', '运维人员');
GO

-- =============================================
-- 3. 插入 RealtimeSummary (实时汇总 - 分钟级)
-- 场景模拟：2025-11-30 上午 10点到10点半
-- 逻辑：能耗累加，光伏发电增加，中间出现一次告警
-- =============================================

INSERT INTO RealtimeSummary (StatTime, TotalElectricityKWh, TotalWaterM3, TotalSteamT, TotalGasM3, TotalPvGenerationKWh, PvSelfUseKWh, TotalAlarmCount, HighAlarmCount, MediumAlarmCount, LowAlarmCount)
VALUES
-- 10:00:00 正常运行
('2025-11-30 10:00:00', 15000.00, 500.00, 100.00, 2000.00, 800.00, 780.00, 0, 0, 0, 0),

-- 10:05:00 用电量增加 120度
('2025-11-30 10:05:00', 15120.50, 502.10, 101.20, 2010.50, 850.50, 820.50, 0, 0, 0, 0),

-- 10:10:00 用电量增加 130度
('2025-11-30 10:10:00', 15250.80, 505.50, 102.50, 2025.00, 910.00, 880.00, 0, 0, 0, 0),

-- 10:15:00 【突发】出现1个高危告警，2个中危告警
('2025-11-30 10:15:00', 15400.20, 508.80, 104.00, 2040.20, 980.50, 950.00, 3, 1, 2, 0),

-- 10:20:00 告警持续中，用电量继续攀升
('2025-11-30 10:20:00', 15550.60, 512.00, 105.50, 2055.80, 1050.20, 1000.00, 3, 1, 2, 0),

-- 10:25:00 告警已处理（数量归零），光伏发电效率提升
('2025-11-30 10:25:00', 15700.10, 515.20, 107.10, 2070.10, 1120.80, 1080.50, 0, 0, 0, 0);
GO

-- =============================================
-- 4. 插入 HistoryTrend (历史趋势 - 日报)
-- 场景模拟：过去7天的数据，用于 ECharts 折线图
-- 包含：电、水、光伏
-- =============================================

INSERT INTO HistoryTrend (EnergyType, PeriodType, StatTime, Value, YoYRate, MoMRate, IndustryAvgValue, TrendFlag)
VALUES
-- === 电 (单位 KWh) ===
('电', '日', '2025-11-24', 42000.00, 2.5, 1.2, 41000.00, '能耗上升'),
('电', '日', '2025-11-25', 43500.00, 3.0, 3.5, 41000.00, '能耗上升'),
('电', '日', '2025-11-26', 41000.00, -1.5, -5.7, 41500.00, '能耗下降'),
('电', '日', '2025-11-27', 45000.00, 8.5, 9.7, 42000.00, '能耗上升'), -- 峰值
('电', '日', '2025-11-28', 44000.00, 6.2, -2.2, 42000.00, '能耗下降'),
('电', '日', '2025-11-29', 28000.00, -10.5, -36.3, 38000.00, '能耗下降'), -- 周六休息
('电', '日', '2025-11-30', 26000.00, -12.0, -7.1, 38000.00, '能耗下降'), -- 周日休息

-- === 水 (单位 m3) ===
('水', '日', '2025-11-24', 800.00, 1.1, 0.5, 750.00, '平稳'),
('水', '日', '2025-11-25', 820.00, 2.5, 2.5, 750.00, '能耗上升'),
('水', '日', '2025-11-26', 780.00, -2.0, -4.8, 760.00, '能耗下降'),
('水', '日', '2025-11-27', 850.00, 5.0, 8.9, 780.00, '能耗上升'),
('水', '日', '2025-11-28', 840.00, 4.0, -1.1, 780.00, '能耗下降'),
('水', '日', '2025-11-29', 300.00, -20.0, -64.2, 350.00, '能耗下降'),
('水', '日', '2025-11-30', 290.00, -21.0, -3.3, 350.00, '能耗下降'),

-- === 光伏 (单位 KWh) - TrendFlag 复用为 发电趋势 ===
('光伏', '日', '2025-11-24', 5000.00, 10.5, 2.0, 4500.00, '能耗上升'),
('光伏', '日', '2025-11-25', 5200.00, 12.0, 4.0, 4500.00, '能耗上升'),
('光伏', '日', '2025-11-26', 2000.00, -50.0, -61.5, 4000.00, '能耗下降'), -- 阴雨天
('光伏', '日', '2025-11-27', 4800.00, 8.0, 140.0, 4500.00, '能耗上升'), -- 转晴
('光伏', '日', '2025-11-28', 5100.00, 11.0, 6.2, 4600.00, '能耗上升'),
('光伏', '日', '2025-11-29', 5300.00, 13.0, 3.9, 4600.00, '能耗上升'),
('光伏', '日', '2025-11-30', 5400.00, 14.0, 1.9, 4600.00, '能耗上升');
GO